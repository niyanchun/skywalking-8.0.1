{"remainingRequest":"/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/thread-loader/dist/cjs.js!/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/babel-loader/lib/index.js!/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/ts-loader/index.js??ref--13-3!/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/src/event-bus.ts","dependencies":[{"path":"/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/src/event-bus.ts","mtime":1592485041000},{"path":"/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/ts-loader/index.js","mtime":1545640398000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _classCallCheck from \"/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\n\n/**\n * Licensed to the Apache Software Foundation (ASF) under one or more\n * contributor license agreements.  See the NOTICE file distributed with\n * this work for additional information regarding copyright ownership.\n * The ASF licenses this file to You under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with\n * the License.  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport Vue from 'vue';\nexport var EventBus =\n/*#__PURE__*/\nfunction () {\n  function EventBus(vue) {\n    _classCallCheck(this, EventBus);\n\n    if (!this.handles) {\n      Object.defineProperty(this, 'handles', {\n        value: {},\n        enumerable: false\n      });\n    }\n\n    this.Vue = Vue; // _uid and event name map\n\n    this.eventMapUid = {};\n  }\n  /**\n   * Map events and component relationships while listening for events.\n   * @param eventName\n   * @param vm vue component object or undefined, if is undefined, event not auto destroy.\n   * @param callback event callback\n   */\n\n\n  _createClass(EventBus, [{\n    key: \"$on\",\n    value: function $on(eventName, vm, callback) {\n      if (!this.handles[eventName]) {\n        this.handles[eventName] = [];\n      }\n\n      this.handles[eventName].push(callback);\n\n      if (vm instanceof this.Vue) {\n        var vueComponentVM = vm;\n        this.setEventMapUid(vueComponentVM._uid, eventName);\n      }\n    }\n    /**\n     * eventBus.$emit.\n     * @param eventName\n     * @param params\n     */\n\n  }, {\n    key: \"$emit\",\n    value: function $emit(eventName) {\n      if (this.handles[eventName]) {\n        var len = this.handles[eventName].length;\n\n        for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          params[_key - 1] = arguments[_key];\n        }\n\n        for (var i = 0; i < len; i++) {\n          var _this$handles$eventNa;\n\n          (_this$handles$eventNa = this.handles[eventName])[i].apply(_this$handles$eventNa, params);\n        }\n      }\n    }\n    /**\n     * eventBus.$off.\n     * @param eventName\n     */\n\n  }, {\n    key: \"$off\",\n    value: function $off(eventName) {\n      delete this.handles[eventName];\n    }\n    /**\n     * eventBus.$offVmEvent.\n     * @param uid uid of VueComponentVM\n     */\n\n  }, {\n    key: \"$offVmEvent\",\n    value: function $offVmEvent(uid) {\n      var _this = this;\n\n      var currentEvents = this.eventMapUid[uid] || [];\n      currentEvents.forEach(function (event) {\n        _this.$off(event);\n      });\n    }\n  }, {\n    key: \"setEventMapUid\",\n    value: function setEventMapUid(uid, eventName) {\n      if (!this.eventMapUid[uid]) {\n        this.eventMapUid[uid] = [];\n      } // Push the name of each _uid subscription to the array to which the respective uid belongs.\n\n\n      this.eventMapUid[uid].push(eventName);\n    }\n  }]);\n\n  return EventBus;\n}();\nvar $EventBus = {\n  install: function install(vue) {\n    vue.prototype.$eventBus = new EventBus(vue);\n    vue.mixin({\n      deactivated: function deactivated() {\n        this.$eventBus.$offVmEvent(this._uid);\n      },\n      beforeDestroy: function beforeDestroy() {\n        this.$eventBus.$offVmEvent(this._uid);\n      }\n    });\n  }\n};\nexport default $EventBus;",{"version":3,"sources":["/Volumes/Files/Study/apm/apache-skywalking-apm-8.0.1/skywalking-ui/src/event-bus.ts"],"names":[],"mappings":";;;;AAAA;;;;;;;;;;;;;;;;AAiBA,OAAO,GAAP,MAAoC,KAApC;AAQA,WAAa,QAAb;AAAA;AAAA;AAKE,oBAAY,GAAZ,EAA+B;AAAA;;AAC7B,QAAI,CAAC,KAAK,OAAV,EAAmB;AACjB,MAAA,MAAM,CAAC,cAAP,CAAsB,IAAtB,EAA4B,SAA5B,EAAuC;AACrC,QAAA,KAAK,EAAE,EAD8B;AAErC,QAAA,UAAU,EAAE;AAFyB,OAAvC;AAID;;AACD,SAAK,GAAL,GAAW,GAAX,CAP6B,CAQ7B;;AACA,SAAK,WAAL,GAAmB,EAAnB;AACD;AAED;;;;;;;;AAjBF;AAAA;AAAA,wBAwBI,SAxBJ,EAyBI,EAzBJ,EA0BI,QA1BJ,EA0B+B;AAE3B,UAAI,CAAC,KAAK,OAAL,CAAa,SAAb,CAAL,EAA8B;AAC5B,aAAK,OAAL,CAAa,SAAb,IAA0B,EAA1B;AACD;;AACD,WAAK,OAAL,CAAa,SAAb,EAAwB,IAAxB,CAA6B,QAA7B;;AACA,UAAI,EAAE,YAAY,KAAK,GAAvB,EAA4B;AAC1B,YAAM,cAAc,GAAG,EAAvB;AACA,aAAK,cAAL,CAAoB,cAAc,CAAC,IAAnC,EAAyC,SAAzC;AACD;AACF;AAED;;;;;;AAtCF;AAAA;AAAA,0BA2Ce,SA3Cf,EA2CgD;AAC5C,UAAI,KAAK,OAAL,CAAa,SAAb,CAAJ,EAA6B;AAC3B,YAAM,GAAG,GAAG,KAAK,OAAL,CAAa,SAAb,EAAwB,MAApC;;AAD2B,0CADI,MACJ;AADI,UAAA,MACJ;AAAA;;AAE3B,aAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,GAApB,EAAyB,CAAC,EAA1B,EAA8B;AAAA;;AAC5B,wCAAK,OAAL,CAAa,SAAb,GAAwB,CAAxB,+BAA8B,MAA9B;AACD;AACF;AACF;AAED;;;;;AApDF;AAAA;AAAA,yBAwDc,SAxDd,EAwD+B;AAC3B,aAAO,KAAK,OAAL,CAAa,SAAb,CAAP;AACD;AAED;;;;;AA5DF;AAAA;AAAA,gCAgEqB,GAhErB,EAgEgC;AAAA;;AAC5B,UAAM,aAAa,GAAG,KAAK,WAAL,CAAiB,GAAjB,KAAyB,EAA/C;AACA,MAAA,aAAa,CAAC,OAAd,CAAsB,UAAC,KAAD,EAAe;AACnC,QAAA,KAAI,CAAC,IAAL,CAAU,KAAV;AACD,OAFD;AAGD;AArEH;AAAA;AAAA,mCAuEyB,GAvEzB,EAuEsC,SAvEtC,EAuEuD;AACnD,UAAI,CAAC,KAAK,WAAL,CAAiB,GAAjB,CAAL,EAA4B;AAC1B,aAAK,WAAL,CAAiB,GAAjB,IAAwB,EAAxB;AACD,OAHkD,CAInD;;;AACA,WAAK,WAAL,CAAiB,GAAjB,EAAsB,IAAtB,CAA2B,SAA3B;AACD;AA7EH;;AAAA;AAAA;AAgFA,IAAM,SAAS,GAAG;AAChB,EAAA,OAAO,EAAE,iBAAC,GAAD,EAAwB;AAC/B,IAAA,GAAG,CAAC,SAAJ,CAAc,SAAd,GAA0B,IAAI,QAAJ,CAAa,GAAb,CAA1B;AACA,IAAA,GAAG,CAAC,KAAJ,CAAU;AACR,MAAA,WADQ,yBACG;AACR,aAAwB,SAAxB,CAAkC,WAAlC,CACE,KAAwB,IAD1B;AAGF,OALO;AAMR,MAAA,aANQ,2BAMK;AACV,aAAwB,SAAxB,CAAkC,WAAlC,CACE,KAAwB,IAD1B;AAGF;AAVO,KAAV;AAYD;AAfe,CAAlB;AAkBA,eAAe,SAAf","sourcesContent":["/**\n * Licensed to the Apache Software Foundation (ASF) under one or more\n * contributor license agreements.  See the NOTICE file distributed with\n * this work for additional information regarding copyright ownership.\n * The ASF licenses this file to You under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with\n * the License.  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Vue, { VueConstructor } from 'vue';\n\ntype VueComponentVM = Vue & { _uid: string };\n\ninterface Handles {\n  [key: string]: any[];\n}\n\nexport class EventBus {\n  private readonly Vue: any;\n  private readonly eventMapUid: any;\n  private handles!: Handles;\n\n  constructor(vue: VueConstructor) {\n    if (!this.handles) {\n      Object.defineProperty(this, 'handles', {\n        value: {},\n        enumerable: false,\n      });\n    }\n    this.Vue = Vue;\n    // _uid and event name map\n    this.eventMapUid = {};\n  }\n\n  /**\n   * Map events and component relationships while listening for events.\n   * @param eventName\n   * @param vm vue component object or undefined, if is undefined, event not auto destroy.\n   * @param callback event callback\n   */\n  public $on(\n    eventName: string,\n    vm: Vue | undefined,\n    callback: (cb: any) => void,\n  ) {\n    if (!this.handles[eventName]) {\n      this.handles[eventName] = [];\n    }\n    this.handles[eventName].push(callback);\n    if (vm instanceof this.Vue) {\n      const vueComponentVM = vm as VueComponentVM;\n      this.setEventMapUid(vueComponentVM._uid, eventName);\n    }\n  }\n\n  /**\n   * eventBus.$emit.\n   * @param eventName\n   * @param params\n   */\n  public $emit(eventName: string, ...params: any) {\n    if (this.handles[eventName]) {\n      const len = this.handles[eventName].length;\n      for (let i = 0; i < len; i++) {\n        this.handles[eventName][i](...params);\n      }\n    }\n  }\n\n  /**\n   * eventBus.$off.\n   * @param eventName\n   */\n  public $off(eventName: string) {\n    delete this.handles[eventName];\n  }\n\n  /**\n   * eventBus.$offVmEvent.\n   * @param uid uid of VueComponentVM\n   */\n  public $offVmEvent(uid: string) {\n    const currentEvents = this.eventMapUid[uid] || [];\n    currentEvents.forEach((event: any) => {\n      this.$off(event);\n    });\n  }\n\n  private setEventMapUid(uid: string, eventName: string) {\n    if (!this.eventMapUid[uid]) {\n      this.eventMapUid[uid] = [];\n    }\n    // Push the name of each _uid subscription to the array to which the respective uid belongs.\n    this.eventMapUid[uid].push(eventName);\n  }\n}\n\nconst $EventBus = {\n  install: (vue: VueConstructor) => {\n    vue.prototype.$eventBus = new EventBus(vue);\n    vue.mixin({\n      deactivated() {\n        (this as VueComponentVM).$eventBus.$offVmEvent(\n          (this as VueComponentVM)._uid,\n        );\n      },\n      beforeDestroy() {\n        (this as VueComponentVM).$eventBus.$offVmEvent(\n          (this as VueComponentVM)._uid,\n        );\n      },\n    });\n  },\n};\n\nexport default $EventBus;\n"],"sourceRoot":""}]}